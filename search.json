[{"path":"https://mkarikom.github.io/DURIAN/articles/basic_usage.html","id":"load-the-package-and-data","dir":"Articles","previous_headings":"","what":"Load the package and data","title":"Basic Usage","text":"","code":"library(DURIAN) data(c(\"C\",\"B\",\"pDataC\"))"},{"path":"https://mkarikom.github.io/DURIAN/articles/basic_usage.html","id":"run-imputation-on-the-single-cell-data-using-the-bulk-data-for-supervision-","dir":"Articles","previous_headings":"","what":"Run imputation on the single-cell data, using the bulk data for supervision.","title":"Basic Usage","text":"","code":"impresult_list=run_durian(       scrabble_parameters = c(1,1e-6,1e-4),       nEM = 5,       scdata = C,       metadata = pDataC,       bulkdata = B,       deconv_method = \"MuSiC\",       nIter_outer = 10,       nIter_inner = 10,       nSDCIters = 500000,       DECONVGENETHRESH=-0.01,       SCRGENETHRESH=-0.01,       outerStats = FALSE,       durianEps=1e-3,       saveImputationLog = FALSE,       saveDeconvolutionLog = FALSE,       saveImputedStep=FALSE)   impresult = impresult_list[[\"C\"]]"},{"path":"https://mkarikom.github.io/DURIAN/articles/basic_usage.html","id":"construct-a-low-dimensional-umap-embedding-from-imputed-and-original-data","dir":"Articles","previous_headings":"","what":"Construct a low-dimensional UMAP embedding from imputed and original data","title":"Basic Usage","text":"","code":"library(umap) library(ggplot2) library(reshape2) umap_imputed = umap(t(impresult)) umap_orig = umap(t(as.matrix(C))) imputed_df = cbind(umap_imputed$layout,pDataC) imputed_df$status = \"Imputed\" orig_df = cbind(umap_orig$layout,pDataC) orig_df$status = \"Unimputed\" df = rbind(imputed_df,orig_df) colnames(df) = c(\"UMAP1\",\"UMAP2\",\"cellID\",\"cellType\",\"sampleID\",\"status\") df$status = factor(df$status,levels=c(\"Unimputed\",\"Imputed\"))"},{"path":"https://mkarikom.github.io/DURIAN/articles/basic_usage.html","id":"plot-the-original-and-imputed-data","dir":"Articles","previous_headings":"","what":"Plot the original and imputed data","title":"Basic Usage","text":"","code":"ggplot(df,aes(x=UMAP1, y=UMAP2,color=cellType)) +        geom_point(size=1)+       facet_grid(~status,scales=\"free\") + theme_bw()"},{"path":"https://mkarikom.github.io/DURIAN/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Matt Karikomi. Maintainer.","code":""},{"path":"https://mkarikom.github.io/DURIAN/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Karikomi M (2022). DURIAN: Deconvolution Multitask Regression-Based Imputation. https://github.com/mkarikom/DURIAN, https://mkarikom.github.io/DURIAN/.","code":"@Manual{,   title = {DURIAN: Deconvolution and Multitask Regression-Based Imputation},   author = {Matt Karikomi},   year = {2022},   note = {https://github.com/mkarikom/DURIAN, https://mkarikom.github.io/DURIAN/}, }"},{"path":"https://mkarikom.github.io/DURIAN/index.html","id":"durian-","dir":"","previous_headings":"","what":"Deconvolution and Multitask Regression-Based Imputation","title":"Deconvolution and Multitask Regression-Based Imputation","text":"DURIAN (Deconvolution mUltitask-Regression-based ImputAtioN) hybrid, iterative method imputation drop-single-cell expression data. Automatic recovery missing single-cell reads supervised deconvoluted bulk expression data.","code":""},{"path":"https://mkarikom.github.io/DURIAN/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Deconvolution and Multitask Regression-Based Imputation","text":"Install pipeline example data GitHub.","code":"# Install the latest version from github library(devtools) install_github(\"mkarikom/DURIAN\")"},{"path":"https://mkarikom.github.io/DURIAN/index.html","id":"module-selection","dir":"","previous_headings":"","what":"Module Selection","title":"Deconvolution and Multitask Regression-Based Imputation","text":"DURIAN supports integration custom deconvolution modules, even modules written languages, Julia. Current deconvolution alternatives include: fast, NNLS regression using MuSiC (R) distributed Monte Carlo inference using dsLDA (Julia)","code":""},{"path":"https://mkarikom.github.io/DURIAN/index.html","id":"getting-started","dir":"","previous_headings":"","what":"Getting Started","title":"Deconvolution and Multitask Regression-Based Imputation","text":"Check basic usage DURIAN running visualizing imputation Human single-cell data vignette(\"basic_usage\").","code":""},{"path":"https://mkarikom.github.io/DURIAN/index.html","id":"load-the-package-and-data","dir":"","previous_headings":"Getting Started","what":"Load the package and data","title":"Deconvolution and Multitask Regression-Based Imputation","text":"","code":"library(DURIAN) data(c(\"C\",\"T\",\"pDataC\"))"},{"path":"https://mkarikom.github.io/DURIAN/index.html","id":"run-imputation-on-the-single-cell-data-using-the-bulk-data-for-supervision","dir":"","previous_headings":"Getting Started","what":"Run imputation on the single-cell data, using the bulk data for supervision.","title":"Deconvolution and Multitask Regression-Based Imputation","text":"","code":"impresult_list=run_durian(       scrabble_parameters = c(1,1e-6,1e-4),       nEM = 5,       scdata = C,       metadata = pDataC,       bulkdata = T,       deconv_method = \"MuSiC\",       nIter_outer = 10,       nIter_inner = 10,       nSDCIters = 500000,       DECONVGENETHRESH=-0.01,       SCRGENETHRESH=-0.01,       outerStats = FALSE,       durianEps=1e-3,       saveImputationLog = FALSE,       saveDeconvolutionLog = FALSE,       saveImputedStep=FALSE)   impresult = impresult_list[[\"C\"]]"},{"path":"https://mkarikom.github.io/DURIAN/index.html","id":"construct-a-low-dimensional-umap-embedding-from-imputed-and-original-data","dir":"","previous_headings":"Getting Started","what":"Construct a low-dimensional UMAP embedding from imputed and original data","title":"Deconvolution and Multitask Regression-Based Imputation","text":"","code":"library(umap) library(ggplot2) library(reshape2) umap_imputed = umap(t(impresult)) umap_orig = umap(t(as.matrix(C))) imputed_df = cbind(umap_imputed$layout,pDataC) imputed_df$status = \"Imputed\" orig_df = cbind(umap_orig$layout,pDataC) orig_df$status = \"Unimputed\" df = rbind(imputed_df,orig_df) colnames(df) = c(\"UMAP1\",\"UMAP2\",\"cellID\",\"cellType\",\"sampleID\",\"status\") df$status = factor(df$status,levels=c(\"Unimputed\",\"Imputed\"))"},{"path":"https://mkarikom.github.io/DURIAN/index.html","id":"plot-the-original-and-imputed-data","dir":"","previous_headings":"Getting Started","what":"Plot the original and imputed data","title":"Deconvolution and Multitask Regression-Based Imputation","text":"","code":"ggplot(df,aes(x=UMAP1, y=UMAP2,color=cellType)) +        geom_point(size=1)+       facet_grid(~status,scales=\"free\") + theme_bw()"},{"path":"https://mkarikom.github.io/DURIAN/reference/B.html","id":null,"dir":"Reference","previous_headings":"","what":"Bulk sequencing of normal skin from human atopic dermatitis patients — B","title":"Bulk sequencing of normal skin from human atopic dermatitis patients — B","text":"Normal skin tissue 20 patients.","code":""},{"path":"https://mkarikom.github.io/DURIAN/reference/B.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bulk sequencing of normal skin from human atopic dermatitis patients — B","text":"","code":"B"},{"path":"https://mkarikom.github.io/DURIAN/reference/B.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Bulk sequencing of normal skin from human atopic dermatitis patients — B","text":"data frame 6000 genes 20 donors:","code":""},{"path":"https://mkarikom.github.io/DURIAN/reference/B.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Bulk sequencing of normal skin from human atopic dermatitis patients — B","text":"https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE65832","code":""},{"path":"https://mkarikom.github.io/DURIAN/reference/C.html","id":null,"dir":"Reference","previous_headings":"","what":"Single-cell sequencing of normal skin from human atopic dermatitis patients — C","title":"Single-cell sequencing of normal skin from human atopic dermatitis patients — C","text":"Approximately 500 cells, randomly sub-sampled data.","code":""},{"path":"https://mkarikom.github.io/DURIAN/reference/C.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Single-cell sequencing of normal skin from human atopic dermatitis patients — C","text":"","code":"C"},{"path":"https://mkarikom.github.io/DURIAN/reference/C.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Single-cell sequencing of normal skin from human atopic dermatitis patients — C","text":"data frame 5991 genes 472 cells:","code":""},{"path":"https://mkarikom.github.io/DURIAN/reference/C.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Single-cell sequencing of normal skin from human atopic dermatitis patients — C","text":"https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE147424","code":""},{"path":"https://mkarikom.github.io/DURIAN/reference/getdroprate.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the differential sparsity of the observed vs original — getdroprate","title":"Get the differential sparsity of the observed vs original — getdroprate","text":"Get differential sparsity observed vs original","code":""},{"path":"https://mkarikom.github.io/DURIAN/reference/getdroprate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the differential sparsity of the observed vs original — getdroprate","text":"","code":"getdroprate(obs, orig)"},{"path":"https://mkarikom.github.io/DURIAN/reference/getmetrics.html","id":null,"dir":"Reference","previous_headings":"","what":"Get benchmark metrics — getmetrics","title":"Get benchmark metrics — getmetrics","text":"Get benchmark metrics","code":""},{"path":"https://mkarikom.github.io/DURIAN/reference/getmetrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get benchmark metrics — getmetrics","text":"","code":"getmetrics(obs.orig, true.orig, useIrlba = TRUE)"},{"path":"https://mkarikom.github.io/DURIAN/reference/pDataC.html","id":null,"dir":"Reference","previous_headings":"","what":"Normal skin from human atopic dermatitis patients — pDataC","title":"Normal skin from human atopic dermatitis patients — pDataC","text":"Labels corresponding re-clustered cells dataset `C`, following DESeq2-based differential marker-selection based disease, given bulk/pseudobulk modality bulk data normal disease tissue samples Suarez-Farinas 2015 et. al. pseudobulk data normal disease cells 2020 et. al..  Differentially-expressed genes selected based adjusted p-value <= 1e-2.","code":""},{"path":"https://mkarikom.github.io/DURIAN/reference/pDataC.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normal skin from human atopic dermatitis patients — pDataC","text":"","code":"pDataC"},{"path":"https://mkarikom.github.io/DURIAN/reference/pDataC.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Normal skin from human atopic dermatitis patients — pDataC","text":"data frame 5991 genes 472 cells:","code":""},{"path":"https://mkarikom.github.io/DURIAN/reference/pDataC.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Normal skin from human atopic dermatitis patients — pDataC","text":"https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE147424","code":""},{"path":"https://mkarikom.github.io/DURIAN/reference/run_durian.html","id":null,"dir":"Reference","previous_headings":"","what":"Run DURIAN on input data — run_durian","title":"Run DURIAN on input data — run_durian","text":"Run DURIAN input data","code":""},{"path":"https://mkarikom.github.io/DURIAN/reference/run_durian.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run DURIAN on input data — run_durian","text":"","code":"run_durian(   path = NULL,   scrabble_parameters = c(1, 1e-06, 1e-04),   nIter_outer = 20,   nIter_inner = 20,   nSDCIters = 10000,   emDiag = FALSE,   nEM = 10,   error_out_threshold = 1e-07,   error_inner_threshold = 1e-05,   C_fn = NULL,   T_fn = NULL,   pDataC_fn = NULL,   scdata = NULL,   bulkdata = NULL,   metadata = NULL,   deconv_method = \"dsLDA\",   MCNITER = 5000,   MCNPARTITIONS = 5,   MCNCHAINS = 2,   MCBLOCKSIZE = 5,   MCPLOT = TRUE,   LDAPHILATENT = 2,   LDABETAPSEUDO = 0,   LDABETAEPS = 0,   LDAALPHA = 0.1,   LDANSCTHRESH = 3,   SCRNSCTHRESH = 3,   DECONVGENETHRESH = 0.01,   SCRGENETHRESH = 0.3,   MINCELLSTOPICCORP = 5,   SCRSCALESC = \"ident\",   SCRSCALEFACSC = 10000,   LDASCALESC = \"ident\",   LDASCALEBLK = \"ident\",   LDASCALEFACSC = 1,   LDASCALEFACBLK = 10000,   LDAINITFLAVOR = \"unif\",   LDARUNQC = FALSE,   LDAVERBOSE = FALSE,   MCTHINNING = 5,   MCRMCHAINS = TRUE,   MCBURNRATE = 0.25,   deconvbenchmark = NULL,   imputebenchmark = NULL,   protectedgenes = c(\"dummygene\"),   maxT = 0,   initscrabble = FALSE,   allScr = TRUE,   limrhat = 10,   durianEps = 1e-06,   saveDeconvolutionLog = FALSE,   saveImputedStep = FALSE,   saveImputationLog = TRUE,   outerStats = FALSE,   useIrlba = TRUE,   runstability = FALSE )"},{"path":"https://mkarikom.github.io/DURIAN/reference/run_durian.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run DURIAN on input data — run_durian","text":"path path input data provided object. scrabble_parameters ADMM parameters","code":""},{"path":"https://mkarikom.github.io/DURIAN/reference/run_durian.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run DURIAN on input data — run_durian","text":"imputed data.","code":""},{"path":"https://mkarikom.github.io/DURIAN/reference/run_scrabble.html","id":null,"dir":"Reference","previous_headings":"","what":"Run original SCRABBLE — run_scrabble","title":"Run original SCRABBLE — run_scrabble","text":"Run original SCRABBLE","code":""},{"path":"https://mkarikom.github.io/DURIAN/reference/run_scrabble.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run original SCRABBLE — run_scrabble","text":"","code":"run_scrabble(   path,   scrabble_parameters = c(1, 1e-06, 1e-04),   nIter_outer = 20,   nIter_inner = 20,   nSDCIters = 10000,   C_fn = \"ldaC.csv.gz\",   T_fn = \"B.csv.gz\",   scdata = NULL,   bulkdata = NULL,   scrcellids = NULL,   scrgeneids = NULL,   imputebenchmark = NULL,   allScr = TRUE,   error_out_threshold = 1e-07,   error_inner_threshold = 1e-05,   outerStats = FALSE,   metadata = NULL,   useIrlba = TRUE,   runstability = FALSE )"},{"path":"https://mkarikom.github.io/DURIAN/reference/run_scrabble.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run original SCRABBLE — run_scrabble","text":"path path input data provided object. scrabble_parameters ADMM parameters","code":""},{"path":"https://mkarikom.github.io/DURIAN/reference/run_scrabble.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run original SCRABBLE — run_scrabble","text":"imputed data.","code":""},{"path":"https://mkarikom.github.io/DURIAN/reference/run_scrabble_m.html","id":null,"dir":"Reference","previous_headings":"","what":"Run multitask SCRABBLE (positive control) — run_scrabble_m","title":"Run multitask SCRABBLE (positive control) — run_scrabble_m","text":"Run multitask SCRABBLE (positive control)","code":""},{"path":"https://mkarikom.github.io/DURIAN/reference/run_scrabble_m.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run multitask SCRABBLE (positive control) — run_scrabble_m","text":"","code":"run_scrabble_m(   path,   scrabble_parameters = c(1, 1e-06, 1e-04),   nIter_outer = 20,   nIter_inner = 20,   nSDCIters = 10000,   C_fn = \"ldaC.csv\",   T_fn = \"B.csv\",   pDataC_fn = \"pDataC.csv\",   scdata = NULL,   bulkdata = NULL,   metadata = NULL,   thetahat = NULL,   imputebenchmark = NULL,   scrcellids = NULL,   scrgeneids = NULL,   allScr = TRUE,   error_out_threshold = 1e-07,   error_inner_threshold = 1e-05,   outerStats = FALSE,   useIrlba = TRUE,   runstability = FALSE )"},{"path":"https://mkarikom.github.io/DURIAN/reference/run_scrabble_m.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run multitask SCRABBLE (positive control) — run_scrabble_m","text":"path path input data provided object. scrabble_parameters ADMM parameters","code":""},{"path":"https://mkarikom.github.io/DURIAN/reference/run_scrabble_m.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run multitask SCRABBLE (positive control) — run_scrabble_m","text":"imputed data.","code":""}]
